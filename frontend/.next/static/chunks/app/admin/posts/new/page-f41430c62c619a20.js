(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[629],{2281:function(e,t,a){Promise.resolve().then(a.bind(a,2336))},2336:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var s=a(7437),i=a(2265),l=a(9376),r=a(9501),n=a(3590),c=a(1115);let o=c.z.object({title:c.z.string().min(3,"Title must be at least 3 characters").max(200,"Title cannot exceed 200 characters").trim(),content:c.z.string().min(10,"Content must be at least 10 characters"),status:c.z.enum(["draft","published","archived"]).optional(),tags:c.z.array(c.z.string().trim().toLowerCase()).optional(),featuredImage:c.z.string().url().optional().or(c.z.literal("")),metaTitle:c.z.string().max(60,"Meta title cannot exceed 60 characters").optional(),metaDescription:c.z.string().max(160,"Meta description cannot exceed 160 characters").optional()});o.partial(),c.z.object({page:c.z.string().transform(Number).pipe(c.z.number().min(1).max(1e3)).default("1"),limit:c.z.string().transform(Number).pipe(c.z.number().min(1).max(50)).default("10"),status:c.z.enum(["draft","published","archived"]).optional(),search:c.z.string().optional(),tags:c.z.string().optional(),sortBy:c.z.enum(["createdAt","updatedAt","viewCount","title"]).default("createdAt"),sortOrder:c.z.enum(["asc","desc"]).default("desc")});var d=a(166);a(8527);let m=(0,d.default)(()=>Promise.all([a.e(70),a.e(804)]).then(a.t.bind(a,5600,23)),{loadableGenerated:{webpack:()=>[5600]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"h-64 bg-gray-100 rounded-lg animate-pulse"})});function u(e){let{value:t,onChange:a,placeholder:l="Start writing your content...",className:r="",readOnly:n=!1}=e,c=(0,i.useMemo)(()=>({toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{align:[]}],["link","image","video"],["clean"]],clipboard:{matchVisual:!1}}),[]),o=(0,i.useMemo)(()=>["header","bold","italic","underline","strike","color","background","script","blockquote","code-block","list","bullet","indent","align","link","image","video"],[]);return(0,s.jsxs)("div",{className:"rich-text-editor ".concat(r),children:[(0,s.jsx)(m,{theme:"snow",value:t,onChange:a,modules:c,formats:o,placeholder:l,readOnly:n,className:"min-h-[300px]"}),(0,s.jsxs)("div",{className:"mt-2 text-sm text-gray-500 text-right",children:[t.replace(/<[^>]*>/g,"").length," characters"]})]})}var x=a(9064),p=a(7769),h=a(2208),g=a(3229);function b(e){let{initialData:t,onSubmit:a,isSubmitting:l=!1,mode:c}=e,[d,m]=(0,i.useState)(!1),[b,f]=(0,i.useState)(""),{register:j,handleSubmit:y,watch:v,setValue:N,formState:{errors:k,isDirty:w}}=(0,r.cI)({resolver:(0,n.F)(o),defaultValues:{title:(null==t?void 0:t.title)||"",content:(null==t?void 0:t.content)||"",status:(null==t?void 0:t.status)||"draft",tags:(null==t?void 0:t.tags)||[],featuredImage:(null==t?void 0:t.featuredImage)||"",metaTitle:(null==t?void 0:t.metaTitle)||"",metaDescription:(null==t?void 0:t.metaDescription)||""}}),T=v("title"),S=v("content");(0,i.useEffect)(()=>{if(!w||"edit"===c)return;let e=setTimeout(async()=>{try{let e={title:T,content:S,status:"draft",tags:[],featuredImage:"",metaTitle:"",metaDescription:""};e.title.length>=3&&e.content.length>=10&&(f("Saving..."),await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),f("Auto-saved"),setTimeout(()=>f(""),2e3))}catch(e){console.error("Auto-save failed:",e),f("Auto-save failed")}},3e4);return()=>clearTimeout(e)},[T,S,w,c]);let z=async e=>{try{await a(e),x.ZP.success("Post ".concat("create"===c?"created":"updated"," successfully!"))}catch(e){x.ZP.error(e.message||"Failed to ".concat(c," post"))}},C=e=>{N("tags",(v("tags")||[]).filter(t=>t!==e))};return(0,s.jsxs)("form",{onSubmit:y(z),className:"space-y-6",children:[b&&(0,s.jsx)("div",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-2 rounded-lg",children:b}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),(0,s.jsx)("input",{...j("title"),type:"text",id:"title",className:"input-field",placeholder:"Enter post title...",maxLength:200}),k.title&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.title.message}),(0,s.jsxs)("div",{className:"mt-1 text-sm text-gray-500",children:[T.length,"/200 characters"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Content *"}),(0,s.jsxs)("button",{type:"button",onClick:()=>m(!d),className:"text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[d?(0,s.jsx)(p.Z,{className:"w-4 h-4"}):(0,s.jsx)(h.Z,{className:"w-4 h-4"}),d?"Edit":"Preview"]})]}),d?(0,s.jsx)("div",{className:"prose-custom border border-gray-300 rounded-lg p-4 min-h-[300px]",children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:S}})}):(0,s.jsx)(u,{value:S,onChange:e=>N("content",e),placeholder:"Start writing your content..."}),k.content&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.content.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{...j("status"),id:"status",className:"input-field",children:[(0,s.jsx)("option",{value:"draft",children:"Draft"}),(0,s.jsx)("option",{value:"published",children:"Published"}),(0,s.jsx)("option",{value:"archived",children:"Archived"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,s.jsx)("input",{type:"text",id:"tags",className:"input-field",placeholder:"Type tags and press Enter or comma...",onKeyDown:e=>{if("Enter"===e.key||","===e.key){e.preventDefault();let t=e.currentTarget,a=t.value.trim().toLowerCase(),s=v("tags")||[];a&&!s.includes(a)&&(N("tags",[...s,a]),t.value="")}}}),(v("tags")||[]).length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:(v("tags")||[]).map(e=>(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-primary-100 text-primary-800 text-sm rounded-full",children:[e,(0,s.jsx)("button",{type:"button",onClick:()=>C(e),className:"text-primary-600 hover:text-primary-800",children:"\xd7"})]},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"featuredImage",className:"block text-sm font-medium text-gray-700 mb-2",children:"Featured Image URL"}),(0,s.jsx)("input",{...j("featuredImage"),type:"url",id:"featuredImage",className:"input-field",placeholder:"https://example.com/image.jpg"}),k.featuredImage&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.featuredImage.message})]}),(0,s.jsxs)("div",{className:"border-t pt-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"SEO Settings"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"metaTitle",className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta Title"}),(0,s.jsx)("input",{...j("metaTitle"),type:"text",id:"metaTitle",className:"input-field",placeholder:"SEO title (optional)",maxLength:60}),k.metaTitle&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.metaTitle.message}),(0,s.jsxs)("div",{className:"mt-1 text-sm text-gray-500",children:[(v("metaTitle")||"").length,"/60 characters"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"metaDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Meta Description"}),(0,s.jsx)("textarea",{...j("metaDescription"),id:"metaDescription",rows:3,className:"input-field",placeholder:"SEO description (optional)",maxLength:160}),k.metaDescription&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:k.metaDescription.message}),(0,s.jsxs)("div",{className:"mt-1 text-sm text-gray-500",children:[(v("metaDescription")||"").length,"/160 characters"]})]})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-6 border-t",children:[(0,s.jsxs)("button",{type:"submit",disabled:l,className:"btn-primary flex items-center gap-2 disabled:opacity-50",children:[(0,s.jsx)(g.Z,{className:"w-4 h-4"}),l?"Saving...":"Save ".concat("create"===c?"Post":"Changes")]}),(0,s.jsx)("button",{type:"button",onClick:()=>N("status","draft"),className:"btn-secondary",children:"Save as Draft"})]})]})}function f(){let e=(0,l.useRouter)(),[t,a]=(0,i.useState)(!1),r=async t=>{a(!0);try{let a=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to create post")}let s=await a.json();"published"===t.status?e.push("/posts/".concat(s.post.slug)):e.push("/admin")}catch(e){console.error("Error creating post:",e),x.ZP.error(e.message||"Failed to create post")}finally{a(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Create New Post"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Write and publish your next blog post with our comprehensive editor."})]}),(0,s.jsx)("div",{className:"card",children:(0,s.jsx)(b,{onSubmit:r,isSubmitting:t,mode:"create"})})]})})})}}},function(e){e.O(0,[458,368,607,971,117,744],function(){return e(e.s=2281)}),_N_E=e.O()}]);